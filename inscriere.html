<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Ãnregistrare â€¢ VreauAjutor.ro</title>

  <style>
    :root{
      --bg: #f5f7fb;
      --brand: #0f62fe;
      --text: #0f172a;
      --muted: #6b7280;
      --border: #e5e7eb;
      --card: #fff;
      --radius: 16px;
      --shadow: 0 12px 30px rgba(16,24,40,.12);
      --soft: 0 4px 14px rgba(16,24,40,.06);
      --ok: #059669;
      --bad:#dc2626;
    }

    html,body{height:100%}
    body{
      margin:0;
      font-family: system-ui, Segoe UI, Roboto, Arial, sans-serif;
      color: var(--text);
      background:
        radial-gradient(80vw 60vh at -10% 110%, #ff9f6f 0%, transparent 60%),
        radial-gradient(80vw 60vh at 110% -10%, #6fc2ff 0%, transparent 60%),
        var(--bg);
    }

    .shell{ max-width: 920px; margin: 4vh auto; padding: 0 16px; }
    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    .header{ padding: 28px 28px 10px; }
    .header h1{ margin:0; font-size: clamp(22px,3vw,30px); letter-spacing:-.02em }
    .header p{ margin:8px 0 0; color: var(--muted) }

    /* social buttons */
    .social{ padding: 0 28px 10px; display: grid; gap:12px }
    .btn-social{
      display:flex; align-items:center; justify-content:center; gap:10px;
      border:1px solid var(--border); background:#fff; color:#111; font-weight:800;
      padding:14px 16px; border-radius:12px; cursor:pointer; box-shadow: var(--soft);
      transition: filter .15s, transform .05s, border-color .18s, background .18s;
    }
    .btn-social:hover{ filter:brightness(1.02); background:#fafafa; border-color:#dbe7ff }
    .btn-social:active{ transform: translateY(1px) }
    .btn-social svg{ width:20px; height:20px }

    /* separator */
    .sep{ display:flex; align-items:center; gap:14px; padding: 6px 28px 2px; color:#9ca3af; font-weight:800; }
    .sep:before,.sep:after{ content:""; height:1px; background:var(--border); flex:1 }

    /* content area */
    .content{ padding: 10px 28px 28px; }
    label{ display:block; margin:.6rem 0 .35rem; font-weight:700 }
    .hint{ color: var(--muted); font-size: 13px; margin-top:6px }

    input[type="email"], input[type="password"]{
      width:100%; padding:13px 14px; border:1px solid #dfe3ea; border-radius:12px; background:#fff;
      transition: border-color .18s, box-shadow .18s;
    }
    input:focus{ outline:none; border-color:var(--brand); box-shadow:0 0 0 4px rgba(15,98,254,.12) }

    .pwd-wrap{ position:relative }
    .eye{
      position:absolute; right:10px; top:50%; transform:translateY(-50%);
      border:0; background:#fff; padding:6px; border-radius:8px; cursor:pointer;
    }

    .rules{ margin:12px 0 2px; padding-left:0; list-style:none; }
    .rules li{ display:flex; align-items:center; gap:8px; color:#374151; margin:6px 0; }
    .dot{ width:8px; height:8px; border-radius:50%; background:#cbd5e1 }
    .ok .dot{ background: var(--ok) }
    .bad .dot{ background: var(--bad) }

    .agreements{
      margin-top:12px; color:#374151; font-size:14px;
    }
    .agreements a{ color:var(--brand); text-decoration:none }
    .agreements a:hover{ text-decoration:underline }

    .check{ display:flex; align-items:flex-start; gap:10px; margin-top:12px; }
    .check input{ transform: translateY(3px) }
    .actions{ display:flex; justify-content:flex-end; gap:10px; margin-top:16px }
    .btn{
      padding:12px 18px; border-radius:12px; border:1px solid transparent; cursor:pointer; font-weight:800;
      transition: filter .15s, transform .05s;
    }
    .btn:active{ transform: translateY(1px) }
    .btn-outline{ background:#fff; border-color:#dfe3ea }
    .btn-primary{ background: var(--brand); color:#fff; box-shadow: var(--soft) }
    .btn[disabled]{ opacity:.55; cursor:not-allowed }
    .msg{ margin-top:8px; color:#dc2626; font-weight:700 }

    @media (max-width:560px){
      .btn-social{ padding:12px }
    }
  </style>
</head>
<body>
  <main class="shell">
    <section class="card" aria-label="Ãnregistrare">
      <div class="header">
        <h1>Ãnregistrare</h1>
        <p>Alege o metodÄƒ rapidÄƒ sau foloseÈ™te email + parolÄƒ.</p>
      </div>

      <!-- butoane social -->
      <div class="social">
        <button type="button" class="btn-social" id="fbBtn" aria-label="ContinuÄƒ cu Facebook">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M22 12.06C22 6.49 17.52 2 12 2S2 6.49 2 12.06c0 5.01 3.66 9.16 8.44 9.94v-7.03H7.9v-2.91h2.54V9.41c0-2.5 1.49-3.88 3.77-3.88 1.09 0 2.23.2 2.23.2v2.46h-1.25c-1.24 0-1.62.77-1.62 1.56v1.87h2.76l-.44 2.91h-2.32V22c4.78-.78 8.44-4.93 8.44-9.94z"/></svg>
          ContinuÄƒ cu Facebook
        </button>
        <button type="button" class="btn-social" id="appleBtn" aria-label="ContinuÄƒ cu Apple">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M16.365 1.43c0 1.14-.41 2.1-1.23 2.89-.99.94-2.19 1.48-3.49 1.39-.05-1.09.42-2.14 1.24-2.92.9-.86 2.23-1.48 3.48-1.36zM20.74 17.07c-.62 1.43-.92 2.05-1.72 3.3-1.12 1.74-2.69 3.92-4.67 3.95-1.09.02-1.84-.32-2.81-.32-.97 0-1.68.33-2.83.34-2 .03-3.61-2.13-4.74-3.86-2.59-3.93-2.86-8.55-1.26-10.99 1.15-1.78 2.97-2.84 4.7-2.84 1.1 0 2.02.36 2.73.36.69 0 1.86-.38 3.21-.38 1.16 0 2.38.32 3.35 1.23-2.95 1.7-2.5 6.16.47 7.23-.37 1.01-.82 1.92-1.13 2.98z"/></svg>
          ContinuÄƒ cu Apple
        </button>
        <button type="button" class="btn-social" id="googleBtn" aria-label="ContinuÄƒ cu Google">
          <svg viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M21.35 11.1H12v2.9h5.38c-.23 1.5-1.56 4.4-5.38 4.4a6.22 6.22 0 0 1 0-12.44 5.43 5.43 0 0 1 3.83 1.52l2.6-2.51A9.1 9.1 0 0 0 12 2.1C6.91 2.1 2.8 6.21 2.8 11.3s4.11 9.2 9.2 9.2c5.31 0 8.82-3.72 8.82-8.97 0-.6-.07-1.03-.17-1.43z"/></svg>
          ContinuÄƒ cu Google
        </button>
      </div>

      <div class="sep">SAU</div>

      <!-- formular clasic -->
      <div class="content">
        <label for="email">Adresa ta de e-mail</label>
        <input id="email" type="email" placeholder="ex: nume@domeniu.ro" autocomplete="email" required>

        <label for="password">ParolÄƒ</label>
        <div class="pwd-wrap">
          <input id="password" type="password" placeholder="minim 9 caractere" autocomplete="new-password" required>
          <button class="eye" type="button" id="toggle">ğŸ‘ï¸</button>
        </div>

        <ul class="rules" id="rules">
          <li id="r1"><span class="dot"></span> 9 sau mai multe caractere</li>
          <li id="r2"><span class="dot"></span> LiterÄƒ mare</li>
          <li id="r3"><span class="dot"></span> LiterÄƒ micÄƒ</li>
          <li id="r4"><span class="dot"></span> Cel puÈ›in un numÄƒr</li>
        </ul>

        <p class="agreements">
          Ãn momentul Ã®n care apeÈ™i pe <strong>â€CreeazÄƒ un contâ€</strong>, accepÈ›i
          <a href="/termeni" target="_blank" rel="noopener">Termenii È™i condiÈ›iile</a> È™i
          <a href="/confidentialitate" target="_blank" rel="noopener">Politica de confidenÈ›ialitate</a>.
        </p>

        <label class="check">
          <input id="marketing" type="checkbox">
          <span>Sunt de acord sÄƒ primesc informaÈ›ii È™i oferte prin e-mail sau SMS (opÈ›ional).</span>
        </label>

        <div class="actions">
          <button type="button" class="btn btn-outline" onclick="history.back()">Ãnapoi</button>
          <button type="button" id="createBtn" class="btn btn-primary" disabled>CreeazÄƒ un cont</button>
        </div>

        <div id="msg" class="msg" role="status" aria-live="polite"></div>
      </div>
    </section>
  </main>

  <!-- Supabase (opÈ›ional). DacÄƒ nu foloseÈ™ti, poÈ›i lÄƒsa doar UX-ul local. -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    // --- UX: validare parolÄƒ live + enable buton ---
    const el = {
      email: document.getElementById('email'),
      pwd: document.getElementById('password'),
      r1: document.getElementById('r1'),
      r2: document.getElementById('r2'),
      r3: document.getElementById('r3'),
      r4: document.getElementById('r4'),
      btn: document.getElementById('createBtn'),
      msg: document.getElementById('msg'),
      eye: document.getElementById('toggle'),
      google: document.getElementById('googleBtn'),
      facebook: document.getElementById('fbBtn'),
      apple: document.getElementById('appleBtn'),
    };

    function validEmail(x){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(x||''); }
    function checkPwd(p){
      const tests = [
        [el.r1, (p||'').length >= 9],
        [el.r2, /[A-Z]/.test(p)],
        [el.r3, /[a-z]/.test(p)],
        [el.r4, /\d/.test(p)],
      ];
      let ok = true;
      tests.forEach(([li, pass])=>{
        li.classList.toggle('ok', pass);
        li.classList.toggle('bad', !pass && (p||'').length>0);
        ok = ok && pass;
      });
      return ok;
    }
    function gate(){
      const ok = validEmail(el.email.value) && checkPwd(el.pwd.value);
      el.btn.disabled = !ok;
    }
    ['input','change'].forEach(evt=>{
      el.email.addEventListener(evt, gate);
      el.pwd.addEventListener(evt, gate);
    });
    el.eye.addEventListener('click', ()=>{ el.pwd.type = (el.pwd.type==='password'?'text':'password'); });

    // --- (opÈ›ional) Supabase Auth pentru social/email ---
    (async () => {
      try{
        const r = await fetch('/.netlify/functions/spa_env', { cache:'no-store' });
        if (!r.ok) return; // dacÄƒ nu ai funcÈ›ia, continuÄƒ doar cu UX local
        const { SUPABASE_URL, SUPABASE_ANON_KEY, REDIRECT_TO } = await r.json();
        if (!SUPABASE_URL || !SUPABASE_ANON_KEY) return;

        const supa = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        const redirectTo = REDIRECT_TO || (location.origin + '/ofera-servicii.html');

        async function oauth(provider){
          el.msg.textContent = '';
          const { error } = await supa.auth.signInWithOAuth({ provider, options:{ redirectTo }});
          if (error) el.msg.textContent = error.message || 'Nu am putut porni autentificarea.';
        }
        el.google.addEventListener('click', ()=>oauth('google'));
        el.facebook.addEventListener('click', ()=>oauth('facebook'));
        el.apple.addEventListener('click', ()=>oauth('apple'));

        el.btn.addEventListener('click', async ()=>{
          if (el.btn.disabled) return;
          el.msg.textContent = '';
          const { error } = await supa.auth.signUp({ email: el.email.value.trim(), password: el.pwd.value });
          if (error){ el.msg.textContent = error.message || 'Ãnscrierea a eÈ™uat.'; return; }
          // dupÄƒ signUp mergem direct la â€OferÄƒ serviciiâ€ (sau poÈ›i afiÈ™a â€verificÄƒ-È›i emailulâ€)
          window.location.href = redirectTo;
        });
      }catch(_){ /* ignorÄƒ â€” dacÄƒ nu existÄƒ funcÈ›ia spa_env, UX local rÄƒmÃ¢ne */ }
    })();
  </script>
</body>
</html>