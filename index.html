<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VreauAjutor.ro</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
  <script>AOS.init();</script>
</head>

<body>
  <!-- MODAL autentificare/√Ænregistrare (mutat corect √Æn <body>) -->
  <div id="authModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="inchideModal()">√ó</span>

      <div class="tab-buttons">
        <button onclick="schimbaTab('login')" id="tab-login" class="active">Autentificare</button>
        <button onclick="schimbaTab('register')" id="tab-register">√énregistrare</button>
      </div>

      <div class="tab-content" id="loginForm">
        <input type="text" id="login_email" placeholder="Email">
        <input type="password" id="login_password" placeholder="ParolƒÉ">
        <button onclick="autentificare()">Autentificare</button>
      </div>

      <div class="tab-content" id="registerForm" style="display:none;">
        <input type="text" id="register_name" placeholder="Nume complet">
        <input type="email" id="register_email" placeholder="Email">
        <input type="password" id="register_password" placeholder="ParolƒÉ">
        <input type="text" id="register_location" placeholder="Localitate">
        </select>
        <button onclick="inregistrare()">√énregistrare</button>
        <button type="button" id="googleSignIn" style="width:100%;margin-top:8px">
  ContinuƒÉ cu Google
</button>

      </div>
    </div>
  </div>

  <!-- HEADER -->
  <header>
    <div class="logo">
      <img src="imagini-chatgpt/logo.png" alt="Vreau Ajutor">
      <h1>VreauAjutor.ro</h1>
    </div>
    <nav>
      <a href="#">AcasƒÉ</a>
      <a href="#">Categorii</a>
      <a href="furnizori.html">Furnizori</a>
      <a href="ofera-servicii.html" class="cta-suppliers">OferƒÉ servicii</a>
      <a href="#">Contact</a>
    </nav>
    <div class="auth-buttons">
      <button onclick="openLogin()">Autentificare</button>
      <button onclick="openRegister()">√énregistrare</button>
    </div>
  </header>

  <!-- SLIDER + SELECTOR -->
  <section class="sectiune-slider-selector">
    <div class="slider-modern">
      <div class="slider-container">
        <div class="slides" id="slides">
          <img src="imagini-chatgpt/curatenie.png" alt="CurƒÉ»õenie">
          <img src="imagini-chatgpt/instal.png" alt="Instalator">
          <img src="imagini-chatgpt/mecanic.png" alt="Mecanic">
          <img src="imagini-chatgpt/transport.png" alt="Transport">
          <img src="imagini-chatgpt/bone.png" alt="Bone">
          <img src="imagini-chatgpt/electricieni.png" alt="Electricieni">
        </div>
        <button class="prev" onclick="moveSlide(-1)">‚Äπ</button>
        <button class="next" onclick="moveSlide(1)">‚Ä∫</button>
      </div>
    </div>

    <div class="selector-zona">
  <h3>SelecteazƒÉ zona »ôi serviciul:</h3>

  <label for="judet">Jude»õ:</label>
  <select id="judet" aria-label="Jude»õ">
    <option value="" selected>Alege jude»õul</option>
  </select>

  <label for="oras">Ora»ô:</label>
  <select id="oras" aria-label="Ora»ô">
    <option value="" selected>Alege ora»ôul</option>
  </select>

  <label for="serviciu">Serviciu:</label>
  <select id="serviciu" aria-label="Serviciu">
    <option value="" selected>Alege serviciul</option>
  </select>

  <button type="button" onclick="gotoFurnizori()">CautƒÉ</button>
</div>

  </section>

  <!-- SERVICII POPULARE -->
  <section class="servicii-populare">
    <h2>Servicii Populare</h2>
    <div class="servicii-container">
      <div class="serviciu-box">
        <img src="curatenie.png" alt="CurƒÉ»õenie">
        <p>CurƒÉ»õenie locuin»õe, birouri, spa»õii comerciale</p>
      </div>
      <div class="serviciu-box">
        <img src="instal.png" alt="Instalator">
        <p>Repara»õii instala»õii sanitare, »õevi, robine»õi</p>
      </div>
      <div class="serviciu-box">
        <img src="electricieni.png" alt="Electrician">
        <p>Panouri, prize, iluminat, repara»õii electrice</p>
      </div>
      <div class="serviciu-box">
        <img src="bone.png" alt="Bone">
        <p>√éngrijire copii, dus/adus, supraveghere</p>
      </div>
      <div class="serviciu-box">
        <img src="electrocasnice.png" alt="Electrocasnice">
        <p>Repara»õii electrocasnice, frigidere, ma»ôini de spƒÉlat</p>
      </div>
    </div>
  </section>

  <!-- CUM FUNC»öIONEAZƒÇ -->
  <section class="cum-functioneaza">
    <h2>Cum func»õioneazƒÉ</h2>
    <ol>
      <li>Selectezi jude»õul, ora»ôul »ôi serviciul</li>
      <li>Prime»ôti lista firmelor disponibile</li>
      <li>Plasezi comanda sau iei legƒÉtura direct</li>
    </ol>
  </section>

  <!-- FOOTER -->
  <footer>
    <p>&copy; 2025 VreauAjutor.ro ‚Äì Toate drepturile rezervate.</p>
  </footer>

  <!-- AjutorBot ‚Äì widget plutitor -->
  <div id="ajb-widget" class="minimized">
    <div class="ajb-header" onclick="toggleAjb()">
      <span>AjutorBot ü§ñ</span>
      <span style="margin-left:auto;opacity:.6;font-size:12px;">Click pentru a deschide</span>
    </div>
    <div class="ajb-body">
      <div id="ajb-messages"></div>
      <div class="ajb-input">
        <input id="ajb-input" type="text" placeholder="Scrie mesajul tƒÉu..." onkeydown="if(event.key==='Enter') ajbSend()" />
        <button onclick="ajbSend()">Trimite</button>
      </div>
    </div>
  </div>

  <!-- Scriptul widgetului (endpoints + logica) -->
  <script>
    // Prioritate: ?api=..., altfel default local
    const AJB_API =
  new URLSearchParams(location.search).get('api') ||
  '/chat'; // ‚Üê acum love»ôte func»õia Netlify prin redirectul din netlify.toml

    function toggleAjb(){
      const w = document.getElementById('ajb-widget');
      w.classList.toggle('minimized');
      if (!w.classList.contains('minimized')) {
        setTimeout(() => document.getElementById('ajb-input').focus(), 0);
      }
    }

    function ajbAppend(sender, text){
      const box = document.getElementById('ajb-messages');
      const d = document.createElement('div');
      d.style.margin = '6px 0';
      d.innerHTML = '<strong>' + sender + ':</strong> ' + (text || '');
      box.appendChild(d);
      box.scrollTop = box.scrollHeight;
    }

    async function ajbSend(){
      const inp = document.getElementById('ajb-input');
      const txt = (inp.value || '').trim();
      if(!txt) return;
      ajbAppend('Tu', txt);
      inp.value = '';
      try{
        const r = await fetch(AJB_API, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message: txt })
        });
        if (!r.ok) throw new Error('Request failed: ' + r.status + ' ' + r.statusText);
        const data = await r.json();
        ajbAppend('AjutorBot', data.reply ?? 'RƒÉspuns gol de la server.');
      }catch(e){
        console.error(e);
        ajbAppend('AjutorBot', 'Nu pot contacta serverul. VerificƒÉ dacƒÉ ruleazƒÉ pe http://localhost:3000 »ôi dacƒÉ ai pus OPENAI_API_KEY.');
      }
    }
  </script>
 <script>
  function gotoFurnizori() {
    const judet = document.getElementById('judet')?.value || '';
    const oras = document.getElementById('oras')?.value || '';
    const serviciu = document.getElementById('serviciu')?.value || '';

    const params = new URLSearchParams();
    if (judet) params.set('judet', judet);
    if (oras) params.set('oras', oras);
    if (serviciu) params.set('service', serviciu);

    window.location.href = 'furnizori.html' + (params.toString() ? '?' + params.toString() : '');
  }
 </script>
  <script>
// PopuleazƒÉ servicii + jude»õe la load
document.addEventListener('DOMContentLoaded', async () => {
  try {
    const r = await fetch('/.netlify/functions/lists');
    if (!r.ok) throw new Error('Nu pot lua listele');
    const { services, judete } = await r.json();

    const selServ = document.getElementById('serviciu');
    const selJudet = document.getElementById('judet');

    // servicii
    services.forEach(name => {
      const opt = document.createElement('option');
      opt.value = name;
      opt.textContent = name;
      selServ.appendChild(opt);
    });

    // jude»õe
    judete.forEach(j => {
      const opt = document.createElement('option');
      opt.value = j;
      opt.textContent = j;
      selJudet.appendChild(opt);
    });
  } catch (e) {
    console.error(e);
  }
});

// C√¢nd se schimbƒÉ jude»õul, refacem ora»ôele
document.getElementById('judet').addEventListener('change', async (ev) => {
  const judet = ev.target.value;
  const selOras = document.getElementById('oras');

  // reset orase
  selOras.innerHTML = '';
  const first = document.createElement('option');
  first.value = '';
  first.textContent = 'Alege ora»ôul';
  selOras.appendChild(first);

  if (!judet) return;

  try {
    const r = await fetch('/.netlify/functions/lists?judet=' + encodeURIComponent(judet));
    if (!r.ok) throw new Error('Nu pot lua ora»ôele');
    const { orase } = await r.json();

    orase.forEach(o => {
      const opt = document.createElement('option');
      opt.value = o;
      opt.textContent = o;
      selOras.appendChild(opt);
    });
  } catch (e) {
    console.error(e);
  }
});
</script>
  <!-- Supabase JS (v2) -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  // COMPLETEAZƒÇ cu valorile tale (din Supabase > Project Settings > API)
  const SUPABASE_URL = 'https://zkmpcnoxibcbdxgvhbig.supabase.co';
  const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InprbXBjbm94aWJjYmR4Z3ZoYmlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ2ODQ4NDQsImV4cCI6MjA3MDI2MDg0NH0.m5X_7nPZa71VrzYXLR389DjchbDziLEjw5gm4enbFD8';

  const supa = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  document.getElementById('googleSignIn')?.addEventListener('click', async () => {
    await supa.auth.signInWithOAuth({
      provider: 'google',
      options: {
        redirectTo: window.location.origin + '/auth-callback.html'
      }
    });
  });
</script>

  <!-- Scriptul tƒÉu principal -->
  <script src="script.js"></script>
</body>
</html>
